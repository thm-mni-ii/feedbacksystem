<div style="display: flex; justify-content: space-between; align-items: center">
  <h3>{{ titleText }}</h3>

  <mat-menu #extractionMenu="matMenu">
    <button mat-menu-item (click)="onExtractOptionSelected('text')">
      Nur Text (PDF/Word)
    </button>
    <button mat-menu-item (click)="onExtractOptionSelected('all')">
      Alles (Text + Bilder)
    </button>
  </mat-menu>

  <button mat-button color="primary" [matMenuTriggerFor]="extractionMenu">
    Text aus Datei lesen
  </button>

  <button mat-button color="accent" (click)="toggleEditor()">
    {{ isCodeFile ? "Wechsel zu Text-Editor" : "Wechsel zu Code-Editor" }}
  </button>
  <button mat-button color="warn" (click)="downloadSubmission()">
    Abgabe herunterladen
  </button>
</div>

<input
  type="file"
  #fileInput
  style="display: none"
  (change)="handleFileInput($event)"
  accept=".pdf,.docx,.txt,.java,.ts,.js,.py"
/>

<!-- Ladeanzeige -->
<div *ngIf="processing" class="loading-overlay">
  <div class="loading-popup">
    <mat-spinner></mat-spinner>
    <p>Die Datei wird verarbeitet, bitte warten...</p>
  </div>
</div>

<!-- Normaler Texteditor -->
<div *ngIf="!isCodeFile" class="editor-container">
  <angular-editor
    [config]="editorConfig"
    [(ngModel)]="toSubmit"
    (ngModelChange)="onTextChange($event)"
    [placeholder]="'Schreibe hier deine LÃ¶sung...'"
  >
  </angular-editor>
</div>

<!-- Code-Editor mit Highlighting -->
<app-code-editor
  *ngIf="isCodeFile"
  [codeType]="getLanguageByFileType(fileType)"
  [(content)]="toSubmit"
  (update)="onCodeChange($event)"
></app-code-editor>

<ng-template #errorDialog let-data>
  <h2 mat-dialog-title>Fehler</h2>
  <mat-dialog-content>
    <p>{{ data.message }}</p>
  </mat-dialog-content>
  <mat-dialog-actions align="end">
    <button mat-button mat-dialog-close color="primary">OK</button>
  </mat-dialog-actions>
</ng-template>
