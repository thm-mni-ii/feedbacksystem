<div class="container">
  <app-menu-bar>
    <button
      mat-icon-button
      [routerLink]="['/courses', courseId, 'task', taskId]"
      matTooltip="{{ 'configuration.back-to-task' | i18nextEager }}"
    >
      <mat-icon>arrow_back</mat-icon>
    </button>
    <span class="spacer"></span>
  </app-menu-bar>

  <div class="create-button">
    <button
      mat-raised-button
      color="accent"
      *ngIf="isAuthorized()"
      (click)="addConfig()"
      matTooltip="{{ 'configuration.add-checker' | i18nextEager }}"
    >
      <mat-icon>add</mat-icon>&nbsp;{{
        "configuration.add-checker" | i18nextEager
      }}
    </button>
  </div>

  <mat-card class="card settings-card">
    <div class="settings-card__header">
      <div>
        <h3>{{ "configuration.staged-feedback.title" | i18nextEager }}</h3>
        <p>{{ "configuration.staged-feedback.hint" | i18nextEager }}</p>
      </div>
      <mat-slide-toggle
        color="primary"
        [(ngModel)]="stagedFeedbackConfig.enabled"
        (change)="saveStagedConfig()"
      >
        {{ "configuration.staged-feedback.toggle" | i18nextEager }}
      </mat-slide-toggle>
    </div>
    <div class="settings-card__content" *ngIf="stagedFeedbackConfig.enabled">
      <mat-form-field appearance="outline">
        <mat-label>{{
          "configuration.staged-feedback.limit-label" | i18nextEager
        }}</mat-label>
        <input
          matInput
          type="number"
          [(ngModel)]="stagedFeedbackConfig.initialOrdLimit"
          [min]="1"
          [max]="maxOrder"
          (change)="saveStagedConfig()"
        />
        <mat-hint>{{
          "configuration.staged-feedback.limit-hint" | i18nextEager
        }}</mat-hint>
      </mat-form-field>
    </div>
  </mat-card>

  <mat-card class="card" *ngFor="let configuration of configurations | async">
    <span>{{ configuration.checkerType }}</span>

    <span class="spacer"></span>

    <button
      mat-icon-button
      color="primary"
      [disabled]="!configuration.mainFileUploaded"
      (click)="downloadMainFile(configuration)"
      matTooltip="{{ 'configuration.download-primary-file' | i18nextEager }}"
    >
      <mat-icon>save_alt</mat-icon>
    </button>
    <button
      mat-icon-button
      color="primary"
      [disabled]="!configuration.secondaryFileUploaded"
      (click)="downloadSecondaryFile(configuration)"
      matTooltip="{{ 'configuration.download-secondary-file' | i18nextEager }}"
    >
      <mat-icon>save_alt</mat-icon>
    </button>

    <button
      mat-icon-button
      color="primary"
      (click)="editConfig(configuration)"
      matTooltip="{{ 'configuration.edit-checker' | i18nextEager }}"
    >
      <mat-icon>edit</mat-icon>
    </button>
    <button
      mat-icon-button
      color="primary"
      (click)="deleteConfig(configuration)"
      matTooltip="{{ 'configuration' | i18nextEager }}"
    >
      <mat-icon>delete</mat-icon>
    </button>
  </mat-card>
</div>
