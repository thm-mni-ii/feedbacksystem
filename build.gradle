plugins {
    id 'idea'
    id 'distribution'
}

ext {
    scalaStyleConfig = "$rootDir/scalastyle_config.xml"
}

subprojects { subproject ->
    group 'de.thm.ii'
    version '1.0-SNAPSHOT'
}

task dist(dependsOn: ['ws:installDist', 'secrettoken-checker:installDist', 'sql-checker:installDist', "web-gui:installDist"]) {
    doLast({
        installDist
    })
}

distributions {
    main {
        distributionBaseName = project.name
        contents {
            project.subprojects.each { sub ->
                switch (sub.name) {
                    case 'web-gui':
                        into('ws/http') {
                            from "${sub.buildDir}/install/${sub.name}"
                            include '*/**'
                        }
                        break;
                    case 'ws':
                        into('') {
                            from "${sub.buildDir}/install/"
                            include '*/**'
                        }
                        into(sub.name) {
                            from "${sub.projectDir}"
                            include 'Dockerfile'
                        }
                        break;
                }
            }
        }
    }
}
