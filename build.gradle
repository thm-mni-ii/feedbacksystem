apply plugin: 'idea'
apply plugin: 'distribution'

ext {
    scalaStyleConfig = "$rootDir/scalastyle_config.xml"
}

subprojects { subproject ->
    group 'de.thm.ii'
    version '1.0-SNAPSHOT'
}

task dist(dependsOn: ['java-checker:installDist', 'ws:installDist', 'secrettoken-checker:installDist', 'sql-checker:installDist', "web-gui:installDist"]) {
    doLast({
        tasks.installDist.execute();
    })
}

distributions {
    main {
        baseName = project.name
        contents {
            project.subprojects.each { sub ->
                switch (sub.name) {
                    case 'web-gui':
                        into('ws/http') {
                            from "${sub.buildDir}/install/${sub.name}"
                            include '*/**'
                        }
                        break;
                    case 'ws':
                        into('') {
                            from "${sub.buildDir}/install/"
                            include '*/**'
                        }
                        into(sub.name) {
                            from "${sub.projectDir}"
                            include 'Dockerfile'
                        }
                        break;
                }
            }
        }
    }
}

task wrapper(type: Wrapper) {
    gradleVersion = '4.9'
}

